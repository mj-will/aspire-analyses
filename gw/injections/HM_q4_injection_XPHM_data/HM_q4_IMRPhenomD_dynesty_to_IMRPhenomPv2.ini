label = HM_q4_XPHM_IMRPhenomD_dynesty_to_IMRPhenomPv2
outdir = outdir_HM_q4_XPHM_IMRPhenomD_dynesty_to_IMRPhenomPv2

detectors = [H1, L1, V1]
duration = 8

trigger-time = 1364342674.0
data-dict = {H1:../../data/frame_files_v4/HM_injection_q4_IMRPhenomXPHM_data/injection_0_H1_1364342474_1364346570.hdf5, L1:../../data/frame_files_v4/HM_injection_q4_IMRPhenomXPHM_data/injection_0_L1_1364342474_1364346570.hdf5, V1:../../data/frame_files_v4/HM_injection_q4_IMRPhenomXPHM_data/injection_0_V1_1364342474_1364346570.hdf5}
channel-dict = {H1:MockData, L1:MockData, V1:MockData}

psd-dict={H1:psds/aligo_O3actual_H1_psd.txt, L1:psds/aligo_O3actual_L1_psd.txt, V1:psds/avirgo_O3actual_psd.txt}

waveform-approximant = IMRPhenomPv2

prior-dict = {
    mass_ratio = bilby.gw.prior.Uniform(name='mass_ratio', minimum=0.125, maximum=1)
    chirp_mass = bilby.gw.prior.Uniform(name='chirp_mass', minimum=25, maximum=35)
    luminosity_distance = bilby.gw.prior.UniformSourceFrame(name='luminosity_distance', minimum=1e2, maximum=2000)
    dec = Cosine(name='dec')
    ra = Uniform(name='ra', minimum=0, maximum=2 * np.pi, boundary='periodic')
    theta_jn = Sine(name='theta_jn')
    psi = Uniform(name='psi', minimum=0, maximum=np.pi, boundary='periodic')
    delta_phase = Uniform(name='delta_phase', minimum=0, maximum=2 * np.pi, boundary='periodic')
    a_1 = Uniform(name='a_1', minimum=0, maximum=0.99)
    a_2 = Uniform(name='a_2', minimum=0, maximum=0.99)
    tilt_1 = Sine(name='tilt_1')
    tilt_2 = Sine(name='tilt_2')
    phi_12 = Uniform(name='phi_12', minimum=0, maximum=2 * np.pi, boundary='periodic')
    phi_jl = Uniform(name='phi_jl', minimum=0, maximum=2 * np.pi, boundary='periodic')
}

phase-marginalization = True
distance-marginalization = True
time-marginalization = True

sampler = aspire
sampler-kwargs = {
    'plot': True,
    'n_samples': 1000,
    'n_final_samples': 10_000,
    'bounded_to_unbounded': True,
    'sample_from_prior': ['time_jitter', 'mass_ratio', 'a_1', 'a_2', 'tilt_1', 'tilt_2', 'phi_12', 'phi_jl'],
    'transforms': 4,
    'hidden_features': [32, 32],
    'fit_kwargs': {'n_epochs': 200, 'lr_annealing': True, 'lr': 1e-3, 'batch_size': 256},
    'sample_kwargs': {'sampler': "minipcn_smc", 'adaptive': True, 'target_efficiency': 0.8, 'sampler_kwargs': {'n_steps': 500}},
    'initial_result_file': '/users/mjwill/git_repos/poppy-analyses/gw/injections/HM_q4_injection_XPHM_data/outdir_HM_q4_XPHM_injection_IMRPhenomD_dynesty/final_result/HM_q4_XPHM_injection_IMRPhenomD_data0_1364342674-0_analysis_H1L1V1_result.hdf5'
    'initial_conversion_function': 'aspire_analysis_tools.gw.conversion.generate_all_bbh_parameters',
}

request-cpus = 16
request-memory = 8.0

conda-env = aspire
scheduler = slurm
scheduler-args = partition=sciama3.q,sciama3-5.q,sciama4.q,sciama5-5.q
scheduler-module = system anaconda3
scheduler-analysis-time = 1-00:00:00
